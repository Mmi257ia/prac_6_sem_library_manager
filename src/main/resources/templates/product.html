<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" lang="ru-RU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/styles/bootstrap/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/styles/libraryStyles.css">
    <title>Экземпляры книги</title>
</head>
<body>
<div th:replace="index :: header"></div>
<p class="pageName">Экземпляры книги "<span th:text="${product.name}"></span>"</p>
<div>
    <p class="info">ISBN:
        <span th:text="${product.isbn}" id="isbnShow"></span>
    </p>
    <p class="info">Авторы:
        <a th:href="@{/products?authors={authors}(authors=${authors})}" th:text="${authors}" id="authorsShow"></a>
    </p>
    <p class="info">Издательство:
        <a th:href="@{/products?publisher={publisher}(publisher=${product.publisher.name})}" th:text="${product.publisher.name}" id="publisherShow"></a>
    </p>
    <p class="info" id="yearOfPublishingShow">Год издания:
        <span th:text="${product.yearOfPublishing}"></span>
        <span th:if="${product.yearOfPublishing == null}">-</span>
    </p>
</div>

<div class="container-fluid" style="width: 100%;">
    <div class="row tableRow tableHeaderRow"> <!-- Заголовок -->
        <div class="col-sm tableVerticalLineRight">
            <p class="tableText">ID</p>
        </div>
        <div class="col-sm tableVerticalLineRight">
            <p class="tableText">Дата прибытия в библиотеку</p>
        </div>
        <div class="col-sm tableVerticalLineRight">
            <p class="tableText">Статус</p>
        </div>
        <div class="col-sm tableVerticalLineRight">
            <p class="tableText">Срок возврата</p>
        </div>
        <div class="col-sm-1"></div>
        <div class="col-sm-1"></div>
        <div class="col-sm-1"></div>
    </div>
    <div th:each="bookWithStatus : ${booksList}">
        <div class="row tableRow" id="contentRow"> <!-- Контент -->
            <div class="col-sm tableVerticalLineRight">
                <p th:text="${bookWithStatus.book.id}" class="tableText" id="idShow"></p>
            </div>
            <div class="col-sm tableVerticalLineRight" id="receivingDateShow">
                <p th:if="${bookWithStatus.book.receivingDate == null}" class="tableText">-</p>
                <p th:text="${bookWithStatus.book.receivingDate}" class="tableText"></p>
            </div>
            <div class="col-sm tableVerticalLineRight" id="statusShow">
                <p th:if="${bookWithStatus.issued}" class="tableText" style="color: red;">У читателя</p>
                <p th:if="${!bookWithStatus.issued}" class="tableText" style="color: green;">В библиотеке</p>
            </div>
            <div class="col-sm tableVerticalLineRight" id="deadlineShow">
                <p th:if="${bookWithStatus.deadline == null}" class="tableText">-</p>
                <p th:text="${bookWithStatus.deadline}" class="tableText"></p>
            </div>
            <div class="col-sm-1 tableButtonBlock tableVerticalLineRight">
                <a th:href="@{/books/{id}(id=${bookWithStatus.book.id})}">
                    <button class="internalButton" id="infoButton">Информация</button>
                </a>
            </div>
            <div class="col-sm-1 tableButtonBlock tableVerticalLineRight">
                <a th:href="@{/issue?bookId={bookId}(bookId=${bookWithStatus.book.id})}" th:if="${!bookWithStatus.issued}">
                    <button class="internalButton" id="issueButton">Выдать книгу</button>
                </a>
                <form method="post" action="/return" class="internalButton" th:if="${bookWithStatus.issued}">
                    <input type="hidden" name="bookId" th:value="${bookWithStatus.book.id}">
                    <button type="submit" class="internalButton" id="returnButton">Вернуть книгу</button>
                </form>
            </div>
            <div class="col-sm-1 tableButtonBlock">
                <form method="post" th:action="@{/products/{id}/delete(id=${product.id})}" class="internalButton">
                    <input type="hidden" name="bookId" th:value="${bookWithStatus.book.id}">
                    <button type="submit" class="internalButton deleteButton" id="deleteButton">Удалить из базы</button>
                </form>
            </div>
        </div>
    </div>
    <div class="row tableRow"></div>
    <form method="post" th:action="@{/products/{id}/add(id=${product.id})}" class="row tableRow"> <!-- Добавление книги -->
        <div class="col-sm tableVerticalLineRight">
            <p class="tableText" style="text-align: right;">Дата прибытия в библиотеку: </p>
        </div>
        <div class="col-sm tableVerticalLineRight">
            <input type="date" name="receivingDate" class="internalButton" id="receivingDateInput">
        </div>
        <div class="col-sm tableVerticalLineRight">
            <button type="submit" class="internalButton" id="addButton">Добавить новый экземпляр</button>
        </div>
        <div class="col-sm"></div>
    </form>
    <div class="row tableRow"></div>
</div>
<p>Выше Вы можете ввести дату прибытия нового экземпляра и внести его в базу.</p>
</body>
</html>